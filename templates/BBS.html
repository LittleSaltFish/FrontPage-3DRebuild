{% extends 'base-front.html' %}
{% load static %}

{%block content%}
<main role="main" class="container">
    <div class="d-flex align-items-center p-3 my-3 bg-white rounded shadow-sm">
        <img class="mr-3" src="https://img.imgdb.cn/item/6086d115d1a9ae528fb01908.jpg" alt="" width="48" height="48">
        <div class="lh-100">
            <h6 class="mb-0 text-black lh-100">校史馆讨论组</h6>
            <small>实施卓越教育、培养卓越人才、创造卓越人生</small>
        </div>
    </div>

    <div class="my-3 p-3 bg-white rounded shadow-sm">
        <h3 class="border-bottom border-gray pb-2 mb-0">最近更新</h3>
        {% for time in by_time %}
        {%if time.is_delete is False %}
        <div class="media text-muted pt-3">
            {%if time.user_id is None%}
            <img src="https://img.imgdb.cn/item/6092c5fdd1a9ae528ff71dd9.png" class="bd-placeholder-img mr-2 rounded"
                width="48" height="48">
            {%else%}
            <img src="{{time.user_photo_url}}" class="bd-placeholder-img mr-2 rounded" width="48" height="48">
            {% endif %}
            <div class="media-body pb-3 mb-0 small lh-125 border-bottom border-gray">
                <div class="d-flex justify-content-between align-items-center w-100">
                    {%if time.user_id is None%}
                    <strong class="d-block text-gray-dark h4">已注销</strong>
                    {%else%}
                    <strong class="d-block text-gray-dark h4">{{time.user_name}}</strong>
                    {% endif %}
                    <form method="POST" id="like-{{forloop.counter}}" name="like-{{forloop.counter}}"
                        action="{% url 'user:like_comment'%}">
                        {% csrf_token %}
                        <input type="hidden" name="comment_id" value="{{time.comment_id}}">
                        <div class="btn-group-vertical">
                            <button class="btn btn-outline-success btn-sm" type="submit">点赞</button>
                            <button class="btn btn-outline-dark btn-sm" type="submit"
                                disabled>点赞量：{{time.comment_hot_rate}}</button>
                            <!-- <button class="btn btn-outline-dark btn-sm" type="submit"
                                disabled>id：{{time.comment_id}}</button> -->
                            <button class="btn btn-outline-dark btn-sm" type="submit"
                                disabled>{{time.create_time}}</button>
                        </div>
                    </form>
                </div>
                <span class="d-block w-75">{{time.comment_content|safe}}</span>
            </div>
        </div>
        {%endif%}
        {%endfor%}
        <!-- <small class="d-block text-right mt-3">
            <a href="#">所有记录</a>
        </small> -->
    </div>

    <div class="my-3 p-3 bg-white rounded shadow-sm">
        <h3 class="border-bottom border-gray pb-2 mb-0">热门评论</h3>
        {% for hot in by_hot %}
        {%if hot.is_delete is False %}
        <div class="media text-muted pt-3">

            {%if hot.user_id is None%}
            <img src="https://img.imgdb.cn/item/6092c5fdd1a9ae528ff71dd9.png" class="bd-placeholder-img mr-2 rounded"
                width="48" height="48">
            {%else%}
            <img src="{{hot.user_photo_url}}" class="bd-placeholder-img mr-2 rounded" width="48" height="48">
            {% endif %}

            <div class="media-body pb-3 mb-0 small lh-125 border-bottom border-gray">
                <div class="d-flex justify-content-between align-items-center w-100">
                    {%if hot.user_id is None%}
                    <strong class="text-gray-dark h4">已注销</strong>
                    {%else%}
                    <strong class="text-gray-dark h4">{{hot.user_name}}</strong>
                    {% endif %}
                    <form method="POST" id="like-{{forloop.counter}}" name="like-{{forloop.counter}}"
                        action="{% url 'user:like_comment'%}">
                        {% csrf_token %}
                        <input type="hidden" name="comment_id" value="{{hot.comment_id}}">
                        <div class="btn-group-vertical">
                            <button class="btn btn-outline-success btn-sm" type="submit">点赞</button>
                            <button class="btn btn-outline-dark btn-sm" type="submit"
                                disabled>点赞量：{{hot.comment_hot_rate}}</button>
                            <!-- <button class="btn btn-outline-dark btn-sm" type="submit"
                                disabled>id：{{hot.comment_id}}</button> -->
                            <button class="btn btn-outline-dark btn-sm" type="submit"
                                disabled>{{hot.create_time}}</button>
                        </div>
                    </form>
                </div>
                <span class="d-block w-75">{{hot.comment_content|safe}}</span>
            </div>
        </div>
        {%endif%}
        {%endfor%}
        <!-- <small class="d-block text-right mt-3">
            <a href="#">热门评论</a>
        </small> -->
    </div>
    <form method="POST" action="{% url 'user:make_comment'%}">
        {% csrf_token %}
        <div class="my-3 p-3 bg-white rounded shadow-sm">
            <h3 class="border-bottom border-gray pb-2 mb-3">添加评论</h3>
            <input type="hidden" name="user_name" value="{{user.username}}">
            <input type="hidden" name="user_id" value="{{user.id}}">
            <textarea id="comment" name="comment_content"></textarea>
        </div>
        <div class="text-center">
            <button type="submit" class="btn btn-success btn-lg btn-block mb-3">提交</button>
        </div>
    </form>
</main>
{%endblock%}



<form class="form-inline my-2 my-lg-0" method="POST" action="">
    {% csrf_token %}
    <input class="form-control mr-sm-2" name="SearchInput" type="search" placeholder="Search" aria-label="Search">
    <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
</form>

{%block custom_css%}
<style>
    .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
    }

    @media (min-width: 768px) {
        .bd-placeholder-img-lg {
            font-size: 3.5rem;
        }
    }

</style>
<link href="{% static 'css/BBS.css' %}" rel="stylesheet">
{%endblock%}


{%block custom_js%}
<script src="{% static 'tinymce/tinymce.min.js' %}"></script>
<script>
    tinymce.init({
        selector: 'textarea',
        height: 500,
        language: "zh_CN",
        plugins: "advlist,autolink,lists,link,image,charmap,print,preview,anchor,visualblocks,code,fullscreen,insertdatetime,media,table,paste,bbcode,help,wordcount,toc,link,autosave",
    })

</script>
<link href="{% static 'js/BBS.js' %}" rel="stylesheet">
{%endblock%}
